platform: template
sensors:

# ####### ####################### #######
# ####### Forecast Sensoren Solar #######
# ####### ####################### #######

  forecast_solar_production_now:
    friendly_name: "Forecast Solar Production Now kW"
    value_template: "{{ 
    ((states('sensor.forecast_solar_production_now_1')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_now_2')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_now_3')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_now_4')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_now_5')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_now_6')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_now_7')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_now_8')|replace('unavailable', 0)|float)/1000)|round(0)
    }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
    unique_id: template.forecast_solar_production_now

  forecast_solar_production_current_hour:
    friendly_name: "Forecast Solar Production Current Hour kW"
    value_template: "{{ 
    (states('sensor.forecast_solar_production_current_hour_1')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_current_hour_2')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_current_hour_3')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_current_hour_4')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_current_hour_5')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_current_hour_6')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_current_hour_7')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_current_hour_8')|replace('unavailable', 0)|float)|round(0)
    }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
    unique_id: template.forecast_solar_production_current_hour

  forecast_solar_production_next_hour:
    friendly_name: "Forecast Solar Production Next Hour kW"
    value_template: "{{ 
    (states('sensor.forecast_solar_production_next_hour_1')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_next_hour_2')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_next_hour_3')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_next_hour_4')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_next_hour_5')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_next_hour_6')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_next_hour_7')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_next_hour_8')|replace('unavailable', 0)|float)|round(0)
    }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
    unique_id: template.forecast_solar_production_next_hour

  forecast_solar_production_production_today:
    friendly_name: "Forecast Solar Production Today kW"
    value_template: "{{ 
    (states('sensor.forecast_solar_production_today_1')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_2')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_3')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_4')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_5')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_6')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_7')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_8')|replace('unavailable', 0)|float)|round(0)
    }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
    unique_id: template.forecast_solar_production_production_today

  forecast_solar_production_production_tomorrow:
    friendly_name: "Forecast Solar Production Tomorrow kW"
    value_template: "{{ 
    (states('sensor.forecast_solar_production_tomorrow_1')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_tomorrow_2')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_tomorrow_3')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_tomorrow_4')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_tomorrow_5')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_tomorrow_6')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_tomorrow_7')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_tomorrow_8')|replace('unavailable', 0)|float)|round(0)
    }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
    unique_id: template.forecast_solar_production_production_tomorrow

  forecast_solar_production_today_remaining:
    friendly_name: "Forecast Solar Production Remaining Today kW"
    value_template: "{{ 
    (states('sensor.forecast_solar_production_today_remaining_1')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_remaining_2')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_remaining_3')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_remaining_4')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_remaining_5')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_remaining_6')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_remaining_7')|replace('unavailable', 0)|float +
    states('sensor.forecast_solar_production_today_remaining_8')|replace('unavailable', 0)|float)|round(0)
    }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
    unique_id: template.forecast_solar_production_remaining_today

#
# Einzelsensoren Now mit "unavailable" Schutz
#
  forecast_solar_production_now_1:
    friendly_name: "Forecast Solar Production Now kW 1"
    value_template: "{{ states('forecast_solar_production_now_1') if states('sensor.power_production_now_3')|safe == 'unavailable' else states('sensor.power_production_now_3')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_now_2:
    friendly_name: "Forecast Solar Production Now kW 2"
    value_template: "{{ states('forecast_solar_production_now_2') if states('sensor.power_production_now_4')|safe == 'unavailable' else states('sensor.power_production_now_4')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_now_3:
    friendly_name: "Forecast Solar Production Now kW 3"
    value_template: "{{ states('forecast_solar_production_now_3') if states('sensor.power_production_now_5')|safe == 'unavailable' else states('sensor.power_production_now_5')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_now_4:
    friendly_name: "Forecast Solar Production Now kW 4"
    value_template: "{{ states('forecast_solar_production_now_4') if states('sensor.power_production_now_6')|safe == 'unavailable' else states('sensor.power_production_now_6')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_now_5:
    friendly_name: "Forecast Solar Production Now kW 5"
    value_template: "{{ states('forecast_solar_production_now_5') if states('sensor.power_production_now_7')|safe == 'unavailable' else states('sensor.power_production_now_7')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_now_6:
    friendly_name: "Forecast Solar Production Now kW 6"
    value_template: "{{ states('forecast_solar_production_now_6') if states('sensor.power_production_now_8')|safe == 'unavailable' else states('sensor.power_production_now_8')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_now_7:
    friendly_name: "Forecast Solar Production Now kW 7"
    value_template: "{{ states('forecast_solar_production_now_7') if states('sensor.power_production_now_9')|safe == 'unavailable' else states('sensor.power_production_now_9')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_now_8:
    friendly_name: "Forecast Solar Production Now kW 8"
    value_template: "{{ states('forecast_solar_production_now_8') if states('sensor.power_production_now_10')|safe == 'unavailable' else states('sensor.power_production_now_10')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
#
# Einzelsensoren Current Hour mit "unavailable" Schutz
#
  forecast_solar_production_current_hour_1:
    friendly_name: "Forecast Solar Production Current_hour kW 1"
    value_template: "{{ states('forecast_solar_production_current_hour_1') if states('sensor.energy_current_hour_3')|safe == 'unavailable' else states('sensor.energy_current_hour_3')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_current_hour_2:
    friendly_name: "Forecast Solar Production Current_hour kW 2"
    value_template: "{{ states('forecast_solar_production_current_hour_2') if states('sensor.energy_current_hour_4')|safe == 'unavailable' else states('sensor.energy_current_hour_4')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_current_hour_3:
    friendly_name: "Forecast Solar Production Current_hour kW 3"
    value_template: "{{ states('forecast_solar_production_current_hour_3') if states('sensor.energy_current_hour_5')|safe == 'unavailable' else states('sensor.energy_current_hour_5')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_current_hour_4:
    friendly_name: "Forecast Solar Production Current_hour kW 4"
    value_template: "{{ states('forecast_solar_production_current_hour_4') if states('sensor.energy_current_hour_6')|safe == 'unavailable' else states('sensor.energy_current_hour_6')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_current_hour_5:
    friendly_name: "Forecast Solar Production Current_hour kW 5"
    value_template: "{{ states('forecast_solar_production_current_hour_5') if states('sensor.energy_current_hour_7')|safe == 'unavailable' else states('sensor.energy_current_hour_7')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_current_hour_6:
    friendly_name: "Forecast Solar Production Current_hour kW 6"
    value_template: "{{ states('forecast_solar_production_current_hour_6') if states('sensor.energy_current_hour_8')|safe == 'unavailable' else states('sensor.energy_current_hour_8')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_current_hour_7:
    friendly_name: "Forecast Solar Production Current_hour kW 7"
    value_template: "{{ states('forecast_solar_production_current_hour_7') if states('sensor.energy_current_hour_9')|safe == 'unavailable' else states('sensor.energy_current_hour_9')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_current_hour_8:
    friendly_name: "Forecast Solar Production Current_hour kW 8"
    value_template: "{{ states('forecast_solar_production_current_hour_8') if states('sensor.energy_current_hour_10')|safe == 'unavailable' else states('sensor.energy_current_hour_10')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
#
# Einzelsensoren Next Hour mit "unavailable" Schutz
#
  forecast_solar_production_next_hour_1:
    friendly_name: "Forecast Solar Production Next_hour kW 1"
    value_template: "{{ states('forecast_solar_production_next_hour_1') if states('sensor.energy_next_hour_3')|safe == 'unavailable' else states('sensor.energy_next_hour_3')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_next_hour_2:
    friendly_name: "Forecast Solar Production Next_hour kW 2"
    value_template: "{{ states('forecast_solar_production_next_hour_2') if states('sensor.energy_next_hour_4')|safe == 'unavailable' else states('sensor.energy_next_hour_4')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_next_hour_3:
    friendly_name: "Forecast Solar Production Next_hour kW 3"
    value_template: "{{ states('forecast_solar_production_next_hour_3') if states('sensor.energy_next_hour_5')|safe == 'unavailable' else states('sensor.energy_next_hour_5')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_next_hour_4:
    friendly_name: "Forecast Solar Production Next_hour kW 4"
    value_template: "{{ states('forecast_solar_production_next_hour_4') if states('sensor.energy_next_hour_6')|safe == 'unavailable' else states('sensor.energy_next_hour_6')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_next_hour_5:
    friendly_name: "Forecast Solar Production Next_hour kW 5"
    value_template: "{{ states('forecast_solar_production_next_hour_5') if states('sensor.energy_next_hour_7')|safe == 'unavailable' else states('sensor.energy_next_hour_7')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_next_hour_6:
    friendly_name: "Forecast Solar Production Next_hour kW 6"
    value_template: "{{ states('forecast_solar_production_next_hour_6') if states('sensor.energy_next_hour_8')|safe == 'unavailable' else states('sensor.energy_next_hour_8')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_next_hour_7:
    friendly_name: "Forecast Solar Production Next_hour kW 7"
    value_template: "{{ states('forecast_solar_production_next_hour_7') if states('sensor.energy_next_hour_9')|safe == 'unavailable' else states('sensor.energy_next_hour_9')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_next_hour_8:
    friendly_name: "Forecast Solar Production Next_hour kW 8"
    value_template: "{{ states('forecast_solar_production_next_hour_8') if states('sensor.energy_next_hour_10')|safe == 'unavailable' else states('sensor.energy_next_hour_10')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
#
# Einzelsensoren Today mit "unavailable" Schutz
#
  forecast_solar_production_today_1:
    friendly_name: "Forecast Solar Production Today kW 1"
    value_template: "{{ states('forecast_solar_production_today_1') if states('sensor.energy_production_today_3')|safe == 'unavailable' else states('sensor.energy_production_today_3')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_2:
    friendly_name: "Forecast Solar Production Today kW 2"
    value_template: "{{ states('forecast_solar_production_today_2') if states('sensor.energy_production_today_4')|safe == 'unavailable' else states('sensor.energy_production_today_4')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_3:
    friendly_name: "Forecast Solar Production Today kW 3"
    value_template: "{{ states('forecast_solar_production_today_3') if states('sensor.energy_production_today_5')|safe == 'unavailable' else states('sensor.energy_production_today_5')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_4:
    friendly_name: "Forecast Solar Production Today kW 4"
    value_template: "{{ states('forecast_solar_production_today_4') if states('sensor.energy_production_today_6')|safe == 'unavailable' else states('sensor.energy_production_today_6')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_5:
    friendly_name: "Forecast Solar Production Today kW 5"
    value_template: "{{ states('forecast_solar_production_today_5') if states('sensor.energy_production_today_7')|safe == 'unavailable' else states('sensor.energy_production_today_7')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_6:
    friendly_name: "Forecast Solar Production Today kW 6"
    value_template: "{{ states('forecast_solar_production_today_6') if states('sensor.energy_production_today_8')|safe == 'unavailable' else states('sensor.energy_production_today_8')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_7:
    friendly_name: "Forecast Solar Production Today kW 7"
    value_template: "{{ states('forecast_solar_production_today_7') if states('sensor.energy_production_today_9')|safe == 'unavailable' else states('sensor.energy_production_today_9')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_8:
    friendly_name: "Forecast Solar Production Today kW 8"
    value_template: "{{ states('forecast_solar_production_today_8') if states('sensor.energy_production_today_10')|safe == 'unavailable' else states('sensor.energy_production_today_10')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
#
# Einzelsensoren Tomorrow mit "unavailable" Schutz
#
  forecast_solar_production_tomorrow_1:
    friendly_name: "Forecast Solar Production Tomorrow kW 1"
    value_template: "{{ states('forecast_solar_production_tomorrow_1') if states('sensor.energy_production_tomorrow_3')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_3')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_tomorrow_2:
    friendly_name: "Forecast Solar Production Tomorrow kW 2"
    value_template: "{{ states('forecast_solar_production_tomorrow_2') if states('sensor.energy_production_tomorrow_4')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_4')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_tomorrow_3:
    friendly_name: "Forecast Solar Production Tomorrow kW 3"
    value_template: "{{ states('forecast_solar_production_tomorrow_3') if states('sensor.energy_production_tomorrow_5')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_5')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_tomorrow_4:
    friendly_name: "Forecast Solar Production Tomorrow kW 4"
    value_template: "{{ states('forecast_solar_production_tomorrow_4') if states('sensor.energy_production_tomorrow_6')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_6')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_tomorrow_5:
    friendly_name: "Forecast Solar Production Tomorrow kW 5"
    value_template: "{{ states('forecast_solar_production_tomorrow_5') if states('sensor.energy_production_tomorrow_7')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_7')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_tomorrow_6:
    friendly_name: "Forecast Solar Production Tomorrow kW 6"
    value_template: "{{ states('forecast_solar_production_tomorrow_6') if states('sensor.energy_production_tomorrow_8')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_8')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_tomorrow_7:
    friendly_name: "Forecast Solar Production Tomorrow kW 7"
    value_template: "{{ states('forecast_solar_production_tomorrow_7') if states('sensor.energy_production_tomorrow_9')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_9')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_tomorrow_8:
    friendly_name: "Forecast Solar Production Tomorrow kW 8"
    value_template: "{{ states('forecast_solar_production_tomorrow_8') if states('sensor.energy_production_tomorrow_10')|safe == 'unavailable' else states('sensor.energy_production_tomorrow_10')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
#
# Einzelsensoren Today Remaining mit "unavailable" Schutz
#
  forecast_solar_production_today_remaining_1:
    friendly_name: "Forecast Solar Production Remaining Today kW 1"
    value_template: "{{ states('forecast_solar_production_today_remaining_1') if states('sensor.energy_production_today_remaining')|safe == 'unavailable' else states('sensor.energy_production_today_remaining')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_remaining_2:
    friendly_name: "Forecast Solar Production Remaining Today kW 2"
    value_template: "{{ states('forecast_solar_production_today_remaining_2') if states('sensor.energy_production_today_remaining_2')|safe == 'unavailable' else states('sensor.energy_production_today_remaining_2')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_remaining_3:
    friendly_name: "Forecast Solar Production Remaining Today kW 3"
    value_template: "{{ states('forecast_solar_production_today_remaining_3') if states('sensor.energy_production_today_remaining_3')|safe == 'unavailable' else states('sensor.energy_production_today_remaining_3')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_remaining_4:
    friendly_name: "Forecast Solar Production Remaining Today kW 4"
    value_template: "{{ states('forecast_solar_production_today_remaining_4') if states('sensor.energy_production_today_remaining_4')|safe == 'unavailable' else states('sensor.energy_production_today_remaining_4')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_remaining_5:
    friendly_name: "Forecast Solar Production Remaining Today kW 5"
    value_template: "{{ states('forecast_solar_production_today_remaining_5') if states('sensor.energy_production_today_remaining_5')|safe == 'unavailable' else states('sensor.energy_production_today_remaining_5')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_remaining_6:
    friendly_name: "Forecast Solar Production Remaining Today kW 6"
    value_template: "{{ states('forecast_solar_production_today_remaining_6') if states('sensor.energy_production_today_remaining_6')|safe == 'unavailable' else states('sensor.energy_production_today_remaining_6')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_remaining_7:
    friendly_name: "Forecast Solar Production Remaining Today kW 7"
    value_template: "{{ states('forecast_solar_production_today_remaining_7') if states('sensor.energy_production_today_remaining_7')|safe == 'unavailable' else states('sensor.energy_production_today_remaining_7')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
  forecast_solar_production_today_remaining_8:
    friendly_name: "Forecast Solar Production Remaining Today kW 8"
    value_template: "{{ states('forecast_solar_production_today_remaining_8') if states('sensor.energy_production_today_remaining_8')|safe == 'unavailable' else states('sensor.energy_production_today_remaining_8')|float }}"
    device_class: power
    unit_of_measurement: "kW"
    attribute_templates:
      last_updated:  "{{ now().day|string+'.'+now().month|string+'.'+now().year|string+' '+now().hour|string+':'+now().minute|string }}"
