# ####### ################################# #######
# ####### Luxtronik Sensoren 25  W채rmepumpe #######
# ####### ################################# #######

- sensor:

# Hyst Heizungsregler 
    - name: "Luxtronik25 Hyst HR"
      state: "{% set luxtronik_param = state_attr('sensor.luxtronik_25_param_state', 'parameters') %}
{% if states('sensor.luxtronik_25_param_state') == 'OK' 
  and luxtronik_param
  and 'returnTemperatureHysteresis' in luxtronik_param 
-%}
  {{ luxtronik_param['returnTemperatureHysteresis'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_hyst_hr') }}
{%- endif %}"
      device_class: temperature
      unit_of_measurement: "째C"
      unique_id: template.sensor_luxtronik25_hyst_hr

# Heizgrenze 
    - name: "Luxtronik25 Heizgrenze"
      state: "{% set luxtronik_param = state_attr('sensor.luxtronik_25_param_state', 'parameters') %}
{% if states('sensor.luxtronik_25_param_state') == 'OK' 
  and luxtronik_param
  and 'thresholdHeatingLimit' in luxtronik_param 
-%}
  {{ luxtronik_param['thresholdHeatingLimit'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_heizgrenze') }}
{%- endif %}"
      device_class: temperature
      unit_of_measurement: "째C"
      unique_id: template.sensor_luxtronik25_heizgrenze

# Temperatur Heissgas
    - name: "Luxtronik25 HG"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'temperature_hot_gas' in luxtronik_values 
-%}
  {{ luxtronik_values['temperature_hot_gas'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_hg') }}
{%- endif %}"
      device_class: temperature
      unit_of_measurement: "째C"
      unique_id: template.sensor_luxtronik25_hg

# Bivalenz Level
    - name: "Luxtronik25 BIV"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'bivalentLevel' in luxtronik_values 
-%}
  {{ luxtronik_values['bivalentLevel'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_biv') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_biv

# Betriebszustand aktuell
    - name: "Luxtronik25 BZ"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'WP_BZ_akt' in luxtronik_values 
-%}
  {{ luxtronik_values['WP_BZ_akt'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_bz') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_bz

# hs1 heatpump_state1 Haus 25
    - name: "Luxtronik25 hs1"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'heatpump_state1' in luxtronik_values 
-%}
  {{ luxtronik_values['heatpump_state1'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_hs1') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_hs1

# hs2 heatpump_state2 Haus 25
    - name: "Luxtronik25 hs2"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'heatpump_state2' in luxtronik_values 
-%}
  {{ luxtronik_values['heatpump_state2'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_hs2') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_hs2

# hs3 heatpump_state3 Haus 25
    - name: "Luxtronik25 hs3"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'heatpump_state3' in luxtronik_values 
-%}
  {{ luxtronik_values['heatpump_state3'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_hs3') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_hs3

# osh opStateHeating Haus 25
    - name: "Luxtronik25 osh"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'opStateHeating' in luxtronik_values 
-%}
  {{ luxtronik_values['opStateHeating'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_osh') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_osh

# osm1 opStateMixer1 Haus 25
    - name: "Luxtronik25 osm1"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'opStateMixer1' in luxtronik_values 
-%}
  {{ luxtronik_values['opStateMixer1'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_osm1') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_osm1

# osm2 opStateMixer2 Haus 25
    - name: "Luxtronik25 osm2"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'opStateMixer2' in luxtronik_values 
-%}
  {{ luxtronik_values['opStateMixer2'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_osm2') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_osm2

# osm3 opStateMixer3 Haus 25
    - name: "Luxtronik25 osm3"
      state: "{% set luxtronik_values = state_attr('sensor.luxtronik_25_value_state', 'values') %}
{% if states('sensor.luxtronik_25_value_state') == 'OK' 
  and luxtronik_values
  and 'opStateMixer3' in luxtronik_values 
-%}
  {{ luxtronik_values['opStateMixer3'] }}
{%- else -%}
  {{ states('sensor.luxtronik25_osm3') }}
{%- endif %}"
      unique_id: template.sensor_luxtronik25_osm3

