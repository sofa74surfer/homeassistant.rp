# ####### ########################## #######
# ####### Wattage Sensoren Allgemein #######
# ####### ########################## #######

# Der Allgemeinstrom beinhaltet
# + Allgemeinstrom (4*)
# + Einstellhalle (Haus 21)
# + Umgebung (Haus 21)
# + Schutzr√§ume (Haus 21)
# + Brandanlage (Haus 25)
# - MyStrom
# - Secomat

- sensor:
    - name: "Allgemein Power"
      state: "{{ (0
               + (0 if states('sensor.gplug_haus_19_allgemein_power') == 'unknown' 
                    or states('sensor.gplug_haus_19_allgemein_power') == 'unavailable'
                    else states('sensor.gplug_haus_19_allgemein_power')|float) 
               + (0 if states('sensor.gplug_haus_21_allgemein_power') == 'unknown' 
                    or states('sensor.gplug_haus_21_allgemein_power') == 'unavailable'
                    else states('sensor.gplug_haus_21_allgemein_power')|float) 
               + (0 if states('sensor.gplug_haus_21_einstellhalle_power') == 'unknown' 
                    or states('sensor.gplug_haus_21_einstellhalle_power') == 'unavailable'
                    else states('sensor.gplug_haus_21_einstellhalle_power')|float) 
               + (0 if states('sensor.gplug_haus_21_umgebung_power') == 'unknown' 
                    or states('sensor.gplug_haus_21_umgebung_power') == 'unavailable'
                    else states('sensor.gplug_haus_21_umgebung_power')|float) 
               + (0 if states('sensor.gplug_haus_21_schutzraume_power') == 'unknown' 
                    or states('sensor.gplug_haus_21_schutzraume_power') == 'unavailable'
                    else states('sensor.gplug_haus_21_schutzraume_power')|float) 
               + (0 if states('sensor.gplug_haus_23_allgemein_power') == 'unknown' 
                    or states('sensor.gplug_haus_23_allgemein_power') == 'unavailable'
                    else states('sensor.gplug_haus_23_allgemein_power')|float) 
               + (0 if states('sensor.gplug_haus_25_allgemein_power') == 'unknown' 
                    or states('sensor.gplug_haus_25_allgemein_power') == 'unavailable'
                    else states('sensor.gplug_haus_25_allgemein_power')|float) 
               + (0 if states('sensor.gplug_haus_25_brandanlage_power') == 'unknown' 
                    or states('sensor.gplug_haus_25_brandanlage_power') == 'unavailable'
                    else states('sensor.gplug_haus_25_brandanlage_power')|float) 
               - (0 if states('sensor.mystrom_power') == 'unknown' 
                    or states('sensor.mystrom_power') == 'unavailable'
                    else states('sensor.mystrom_power')|float) 
               - (0 if states('sensor.shelly_secomat_power') == 'unknown' 
                    or states('sensor.shelly_secomat_power') == 'unavailable'
                    else states('sensor.shelly_secomat_power')|float) 
               )|round(0) }}"
      device_class: power
      unit_of_measurement: "W"
      unique_id: template.sensor_allgemein_power